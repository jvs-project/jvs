# Docker Compose file for JVS development and testing
version: '3.8'

services:
  # JVS CLI service
  jvs:
    build:
      context: .
      dockerfile: Dockerfile
    image: ghcr.io/jvs-project/jvs:latest
    container_name: jvs
    working_dir: /workspace
    volumes:
      # Mount current directory to workspace
      - ./workspace:/workspace
      # Persist JVS metadata
      - jvs-data:/workspace/.jvs
    environment:
      - JVS_ENGINE=copy
    # Override with: docker-compose run jvs init my-repo

  # JVS with JuiceFS mount point
  jvs-juicefs:
    build:
      context: .
      dockerfile: Dockerfile
    image: ghcr.io/jvs-project/jvs:latest
    container_name: jvs-juicefs
    working_dir: /workspace
    volumes:
      - ./workspace:/workspace
      - jvs-juicefs-data:/workspace/.jvs
      # JuiceFS mount (requires JuiceFS setup)
      # - juicefs-data:/mnt/juicefs
    environment:
      - JVS_ENGINE=juicefs-clone
    # Add JuiceFS dependencies as needed
    # command: /bin/sh

volumes:
  jvs-data:
    driver: local
  jvs-juicefs-data:
    driver: local
  # juicefs-data:
  #   driver: local
